

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; django_pewtils 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="django_pewtils.managers" href="managers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> django_pewtils
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">Basic functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract_models.html">Abstract models</a></li>
<li class="toctree-l1"><a class="reference internal" href="managers.html">Managers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-functions">Basic functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-core-of-django-pewtils-the-basicextendedmodel-and-basicextendedmanager">The core of Django Pewtils: the <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> and <code class="docutils literal notranslate"><span class="pre">BasicExtendedManager</span></code></a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">django_pewtils</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-functions">
<h2>Basic functions<a class="headerlink" href="#basic-functions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_pewtils</span> <span class="k">import</span> <span class="n">get_model</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;facebook page&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">facebook</span><span class="o">.</span><span class="n">FacebookPage</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;facebookpage&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">facebook</span><span class="o">.</span><span class="n">FacebookPage</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;Facebook_Page&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">facebook</span><span class="o">.</span><span class="n">FacebookPage</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;contenttype&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">django</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">contenttypes</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ContentType</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">django_learning</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">Document</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_pewtils</span> <span class="k">import</span> <span class="n">reset_django_connection</span>
<span class="n">reset_django_connection</span><span class="p">(</span><span class="n">app_name</span><span class="o">=</span><span class="s2">&quot;logos&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_pewtils</span> <span class="k">import</span> <span class="n">get_all_field_names</span>
<span class="n">get_all_field_names</span><span class="p">(</span><span class="n">Politician</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;education_bachelors&#39;</span><span class="p">,</span>
 <span class="s1">&#39;age&#39;</span><span class="p">,</span>
 <span class="s1">&#39;votes_for&#39;</span><span class="p">,</span>
 <span class="s1">&#39;staffers&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_bachelors_institution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;twitter_profiles&#39;</span><span class="p">,</span>
 <span class="s1">&#39;webpages&#39;</span><span class="p">,</span>
 <span class="s1">&#39;votes_against&#39;</span><span class="p">,</span>
 <span class="s1">&#39;military_service_branch&#39;</span><span class="p">,</span>
 <span class="s1">&#39;press_releases&#39;</span><span class="p">,</span>
 <span class="s1">&#39;facebook_pages&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ballotpedia_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">,</span>
 <span class="s1">&#39;command_logs&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_associates&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_md_institution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;contributions_donated&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ranking_member_committees&#39;</span><span class="p">,</span>
 <span class="s1">&#39;military_service&#39;</span><span class="p">,</span>
 <span class="s1">&#39;committees&#39;</span><span class="p">,</span>
 <span class="s1">&#39;elections_won&#39;</span><span class="p">,</span>
 <span class="s1">&#39;current_term_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;cosponsored_bills&#39;</span><span class="p">,</span>
 <span class="s1">&#39;current_term&#39;</span><span class="p">,</span>
 <span class="s1">&#39;caucuses&#39;</span><span class="p">,</span>
 <span class="s1">&#39;valid_wikipedia_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_jd_institution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;suffix&#39;</span><span class="p">,</span>
 <span class="s1">&#39;image_src&#39;</span><span class="p">,</span>
 <span class="s1">&#39;latest_term_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_masters_institution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;profession&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_jd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;military_service_years&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ballotpedia_page&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">,</span>
 <span class="s1">&#39;icpsr_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;chaired_committees&#39;</span><span class="p">,</span>
 <span class="s1">&#39;personal_metrics&#39;</span><span class="p">,</span>
 <span class="s1">&#39;birthday&#39;</span><span class="p">,</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;middle_initial&#39;</span><span class="p">,</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;incumbent_elections&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lis_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_associates_institution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;in_office&#39;</span><span class="p">,</span>
 <span class="s1">&#39;id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;campaigns&#39;</span><span class="p">,</span>
 <span class="s1">&#39;wikipedia_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;commands&#39;</span><span class="p">,</span>
 <span class="s1">&#39;party&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_phd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;hearings&#39;</span><span class="p">,</span>
 <span class="s1">&#39;wikipedia_page&#39;</span><span class="p">,</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;committee_memberships&#39;</span><span class="p">,</span>
 <span class="s1">&#39;party_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;terms&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gender&#39;</span><span class="p">,</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">,</span>
 <span class="s1">&#39;valid_ballotpedia_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;govtrack_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sponsored_bills&#39;</span><span class="p">,</span>
 <span class="s1">&#39;speeches&#39;</span><span class="p">,</span>
 <span class="s1">&#39;latest_term&#39;</span><span class="p">,</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_bio&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_phd_institution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_md&#39;</span><span class="p">,</span>
 <span class="s1">&#39;education_masters&#39;</span><span class="p">,</span>
 <span class="s1">&#39;opensecrets_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;contributions_received&#39;</span><span class="p">,</span>
 <span class="s1">&#39;scrape_logs&#39;</span><span class="p">,</span>
 <span class="s1">&#39;votes_abstained&#39;</span><span class="p">,</span>
 <span class="s1">&#39;relevant_news_articles&#39;</span><span class="p">,</span>
 <span class="s1">&#39;thomas_id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;first_name&#39;</span><span class="p">,</span>
 <span class="s1">&#39;religion&#39;</span><span class="p">,</span>
 <span class="s1">&#39;birthplace&#39;</span><span class="p">,</span>
 <span class="s1">&#39;verifications&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-core-of-django-pewtils-the-basicextendedmodel-and-basicextendedmanager">
<h2>The core of Django Pewtils: the <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> and <code class="docutils literal notranslate"><span class="pre">BasicExtendedManager</span></code><a class="headerlink" href="#the-core-of-django-pewtils-the-basicextendedmodel-and-basicextendedmanager" title="Permalink to this headline">¶</a></h2>
<p>Django Pewtils’ main purpose is to extend the Django ORM with useful
functions for working with records and queries in your database. The
overwhelming majority of these functions can be found on two classes.
The <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> extends Django’s base Model class with
additional row-level functions, and the <code class="docutils literal notranslate"><span class="pre">BasicExtendedManager</span></code> extends
Django’s base Manager class with additional table/query-level functions.
To use these extended classes, just swap out <code class="docutils literal notranslate"><span class="pre">models.Model</span></code> for
<code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> in your model definition. It uses
<code class="docutils literal notranslate"><span class="pre">BasicExtendedManager</span></code> by default, so you don’t even have to worry
about that.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestModel</span><span class="p">(</span><span class="n">BasicExtendedModel</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Let’s start by taking a look at the Politician table, which contains
members of Congress, presidential candidates, and other politicians</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">John</span> <span class="n">Michael</span> <span class="n">Fleig</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">James</span> <span class="n">Berryhill</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Joseph</span> <span class="n">C</span> <span class="n">Miechowicz</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">James</span> <span class="n">Edgar</span> <span class="n">Sr</span> <span class="n">Md</span> <span class="n">Lundeen</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Daniel</span> <span class="n">Cochcran</span> <span class="s1">&#39;Dc&#39;</span> <span class="n">Morrison</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Mary</span> <span class="n">Pallant</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Charles</span> <span class="n">Taylor</span> <span class="n">Sutherland</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Demetrios</span> <span class="n">S</span> <span class="n">Giannaros</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Corinne</span> <span class="n">Nicole</span> <span class="n">Westerfield</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Joseph</span> <span class="n">M</span> <span class="n">Kyrillos</span> <span class="n">Jr</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Paul</span> <span class="n">Andrew</span> <span class="n">Rundquist</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Jim</span> <span class="n">Bussler</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Sona</span> <span class="n">Mehring</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">William</span> <span class="n">G</span><span class="o">.</span> <span class="n">Barnes</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Carol</span> <span class="n">Ann</span> <span class="n">Joyce</span> <span class="n">Larosa</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">John</span> <span class="n">R</span><span class="o">.</span> <span class="n">Cox</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Go</span> <span class="n">Vegan</span> <span class="n">Go</span> <span class="n">Vegan</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Trish</span> <span class="n">Causey</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Christopher</span> <span class="n">Alen</span> <span class="n">Andrade</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;...(remaining elements truncated)...&#39;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">20673</span>
</pre></div>
</div>
<p>If we wanted to quickly grab all of this data and start crunching
numbers, we can do that easily by using the <code class="docutils literal notranslate"><span class="pre">.to_df</span></code> function provided
by the <code class="docutils literal notranslate"><span class="pre">BasicExtendedManager</span></code>, which converts any arbitrary Django
query into a Pandas DataFrame. Just watch your memory with big queries!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>first_name</th>
      <th>middle_initial</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>suffix</th>
      <th>has_press_release_scraper</th>
      <th>religion</th>
      <th>gender</th>
      <th>birthday</th>
      <th>...</th>
      <th>birthplace</th>
      <th>military_service</th>
      <th>military_service_years</th>
      <th>military_service_branch</th>
      <th>profession</th>
      <th>bioguide_bio</th>
      <th>current_term_id</th>
      <th>latest_term_id</th>
      <th>party_id</th>
      <th>in_office</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49974</td>
      <td>John</td>
      <td>Michael</td>
      <td>Fleig</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62869</td>
      <td>James</td>
      <td></td>
      <td>Berryhill</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>49987</td>
      <td>Joseph</td>
      <td>C</td>
      <td>Miechowicz</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50087</td>
      <td>James</td>
      <td>Edgar Sr Md</td>
      <td>Lundeen</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50108</td>
      <td>Daniel</td>
      <td>Cochcran</td>
      <td>Morrison</td>
      <td>Dc</td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20668</th>
      <td>58883</td>
      <td>Julio</td>
      <td></td>
      <td>Castaneda</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20669</th>
      <td>58884</td>
      <td>Samir</td>
      <td></td>
      <td>Jammal</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20670</th>
      <td>58911</td>
      <td>Brian</td>
      <td></td>
      <td>Forde</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20671</th>
      <td>58657</td>
      <td>Joshua</td>
      <td>A</td>
      <td>Mandel</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20672</th>
      <td>58689</td>
      <td>Robert</td>
      <td></td>
      <td>Kennedy</td>
      <td></td>
      <td>Jr.</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>20673 rows × 52 columns</p>
</div><p>We could also pull a random sample using <code class="docutils literal notranslate"><span class="pre">.sample</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Gene</span> <span class="n">Eugene</span> <span class="n">Green</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Michael</span> <span class="n">C</span> <span class="n">Hight</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Jason</span> <span class="n">Kander</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Steven</span> <span class="n">Edward</span> <span class="n">Mirabella</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Harold</span> <span class="n">L</span> <span class="n">Whitfield</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Sheirl</span> <span class="n">Lee</span> <span class="n">Fletcher</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Joe</span> <span class="n">Manchik</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Charles</span> <span class="n">Wayne</span> <span class="n">Dowdy</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Nicholas</span> <span class="n">Tutora</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Matthew</span> <span class="n">Caroll</span> <span class="n">Hook</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>first_name</th>
      <th>middle_initial</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>suffix</th>
      <th>has_press_release_scraper</th>
      <th>religion</th>
      <th>gender</th>
      <th>birthday</th>
      <th>...</th>
      <th>birthplace</th>
      <th>military_service</th>
      <th>military_service_years</th>
      <th>military_service_branch</th>
      <th>profession</th>
      <th>bioguide_bio</th>
      <th>current_term_id</th>
      <th>latest_term_id</th>
      <th>party_id</th>
      <th>in_office</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5804</td>
      <td>Eric</td>
      <td>J. J.</td>
      <td>Massa</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>M</td>
      <td>1959-09-16</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>MASSA, Eric J.J., a Representative from New Yo...</td>
      <td>None</td>
      <td>9827.0</td>
      <td>26.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>45570</td>
      <td>Peter</td>
      <td></td>
      <td>Vivaldi</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>47758</td>
      <td>James</td>
      <td>A</td>
      <td>Hayden</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>51324</td>
      <td>Clinton</td>
      <td></td>
      <td>Desjarlais</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>54965</td>
      <td>Adam</td>
      <td>D</td>
      <td>Shaffer</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>55248</td>
      <td>Myrtle</td>
      <td>Charlotte Montomery</td>
      <td>Carlyle</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>57725</td>
      <td>Billy</td>
      <td></td>
      <td>Falling</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>59130</td>
      <td>Angie</td>
      <td></td>
      <td>Chirino</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>61854</td>
      <td>Wednesday</td>
      <td>Alexandra</td>
      <td>Green</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>64080</td>
      <td>Chris</td>
      <td>B.</td>
      <td>Royal</td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>NaT</td>
      <td>...</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 52 columns</p>
</div><p>The Politician table isn’t <em>super</em> large, but if it was, fully
evaluating the query could cause you problems - by default, Django will
try to load queries into memory, even if you’re just trying to loop over
each record and do something with it one at a time. To help with this,
the <code class="docutils literal notranslate"><span class="pre">.chunk</span></code> function will efficiently load the full list of primary
keys in your query and iterate over them in chunks, to keep things
light.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">politicians</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>  <span class="c1"># Behind the scenes, Django Pewtils will iterate over the records 1000 at a time</span>
    <span class="k">pass</span>  <span class="c1"># do something</span>
</pre></div>
</div>
<p>Similarly, if we want to make bulk changes to a set of records in a
table, we can use the <code class="docutils literal notranslate"><span class="pre">chunk_update</span></code> function. And if your query
stalls when trying to delete records in bulk (like
<code class="docutils literal notranslate"><span class="pre">politicians.delete()</span></code>), then the <code class="docutils literal notranslate"><span class="pre">chunk_delete</span></code> function can help
you delete your records en masse. (For obvious reasons, we won’t be
doing a live example of these here.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="o">.</span><span class="n">chunk_update</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="o">.</span><span class="n">chunk_delete</span><span class="p">()</span>
</pre></div>
</div>
<p>Anyway, let’s explore some of the other Django Pewtils functions with an
example. The records that we see in our Politician table didn’t come
from nowhere - we had to compile our database from a variety of
different data sources. The &#64;unitedstates GitHub is a great place to
start - it has tons of information on members of Congress, including
their names, terms of office, social media accounts, and more. But there
are tons of other sources too: Wikipedia has extensive bios on Congress,
the FEC provides detailed campaign finance data, etc. To bring all of
this data together, we need to harmonize records from these various
sources - which can be difficult because different sources use different
unique identifiers, and not all of the data is perfectly clean.</p>
<p>Let’s see how Django Pewtils can help us with some of these challenges.
Let’s imagine that Dwayne “The Rock” Johnson decides to run for
President in 2024, but drops out of the race after losing to Oprah in
the primaries, runs for Senate, gets elected there instead. He first
shows up in our database via the record below:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initial_record</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;bioguide_id&quot;</span><span class="p">:</span> <span class="s2">&quot;J99999&quot;</span><span class="p">,</span>
    <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dwayne&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Johnson&quot;</span>
<span class="p">}</span>
<span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">initial_record</span><span class="p">)</span>
<span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bioguide_id</span><span class="o">=</span><span class="s2">&quot;J99999&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="n">Johnson</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now let’s say we download data from another source that has some
additional information on politicians - including the FEC ID for Senator
Rock’s failed presidential bid, and the ID for his campaign’s Instagram
account.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_record</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;bioguide_id&quot;</span><span class="p">:</span> <span class="s2">&quot;J99999&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;P99999&quot;</span><span class="p">],</span>
    <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Johnson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nickname&quot;</span><span class="p">:</span> <span class="s2">&quot;The Rock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;instagram_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1234567890&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since we’ve been good database architects and we’ve specified that
<code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code> is a unique field, if we try to create a new record for
Mr. Rock, it’s going to fail because our first record already exists.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">new_record</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="n">UniqueViolation</span>                           <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">ignored_wrapper_args</span><span class="p">)</span>
     <span class="mi">83</span>             <span class="k">else</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">84</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
     <span class="mi">85</span>


<span class="n">UniqueViolation</span><span class="p">:</span> <span class="n">duplicate</span> <span class="n">key</span> <span class="n">value</span> <span class="n">violates</span> <span class="n">unique</span> <span class="n">constraint</span> <span class="s2">&quot;logos_politician_bioguide_id_317c4279_uniq&quot;</span>
<span class="n">DETAIL</span><span class="p">:</span>  <span class="n">Key</span> <span class="p">(</span><span class="n">bioguide_id</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">J99999</span><span class="p">)</span> <span class="n">already</span> <span class="n">exists</span><span class="o">.</span>



<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>


<span class="n">IntegrityError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">22</span><span class="o">-</span><span class="mi">4</span><span class="n">cfe6540bccd</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">new_record</span><span class="p">)</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">manager</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">manager_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">83</span>         <span class="k">def</span> <span class="nf">create_method</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
     <span class="mi">84</span>             <span class="k">def</span> <span class="nf">manager_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">---&gt;</span> <span class="mi">85</span>                 <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">(),</span> <span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">86</span>             <span class="n">manager_method</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span>
     <span class="mi">87</span>             <span class="n">manager_method</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__doc__</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">445</span>         <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">446</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_for_write</span> <span class="o">=</span> <span class="kc">True</span>
<span class="o">--&gt;</span> <span class="mi">447</span>         <span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">force_insert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">using</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>
    <span class="mi">448</span>         <span class="k">return</span> <span class="n">obj</span>
    <span class="mi">449</span>


<span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">logos</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">django_verifications</span><span class="o">/</span><span class="n">django_verifications</span><span class="o">/</span><span class="n">models</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">90</span>                         <span class="p">)</span>
     <span class="mi">91</span>
<span class="o">---&gt;</span> <span class="mi">92</span>         <span class="nb">super</span><span class="p">(</span><span class="n">VerifiedModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">93</span>
     <span class="mi">94</span>     <span class="k">def</span> <span class="nf">get_verification_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_insert</span><span class="p">,</span> <span class="n">force_update</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">update_fields</span><span class="p">)</span>
    <span class="mi">752</span>
    <span class="mi">753</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_base</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="n">using</span><span class="p">,</span> <span class="n">force_insert</span><span class="o">=</span><span class="n">force_insert</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">754</span>                        <span class="n">force_update</span><span class="o">=</span><span class="n">force_update</span><span class="p">,</span> <span class="n">update_fields</span><span class="o">=</span><span class="n">update_fields</span><span class="p">)</span>
    <span class="mi">755</span>     <span class="n">save</span><span class="o">.</span><span class="n">alters_data</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="mi">756</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">save_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">force_insert</span><span class="p">,</span> <span class="n">force_update</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">update_fields</span><span class="p">)</span>
    <span class="mi">790</span>             <span class="n">updated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_table</span><span class="p">(</span>
    <span class="mi">791</span>                 <span class="n">raw</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">force_insert</span> <span class="ow">or</span> <span class="n">parent_inserted</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">792</span>                 <span class="n">force_update</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">update_fields</span><span class="p">,</span>
    <span class="mi">793</span>             <span class="p">)</span>
    <span class="mi">794</span>         <span class="c1"># Store the database on which the object was saved</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_save_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">force_insert</span><span class="p">,</span> <span class="n">force_update</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">update_fields</span><span class="p">)</span>
    <span class="mi">893</span>
    <span class="mi">894</span>             <span class="n">returning_fields</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">db_returning_fields</span>
<span class="o">--&gt;</span> <span class="mi">895</span>             <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_insert</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_base_manager</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">returning_fields</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
    <span class="mi">896</span>             <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
    <span class="mi">897</span>                 <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">returning_fields</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_do_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">manager</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">returning_fields</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
    <span class="mi">933</span>         <span class="k">return</span> <span class="n">manager</span><span class="o">.</span><span class="n">_insert</span><span class="p">(</span>
    <span class="mi">934</span>             <span class="p">[</span><span class="bp">self</span><span class="p">],</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span> <span class="n">returning_fields</span><span class="o">=</span><span class="n">returning_fields</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">935</span>             <span class="n">using</span><span class="o">=</span><span class="n">using</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">,</span>
    <span class="mi">936</span>         <span class="p">)</span>
    <span class="mi">937</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">manager</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">manager_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">83</span>         <span class="k">def</span> <span class="nf">create_method</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
     <span class="mi">84</span>             <span class="k">def</span> <span class="nf">manager_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">---&gt;</span> <span class="mi">85</span>                 <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">(),</span> <span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">86</span>             <span class="n">manager_method</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span>
     <span class="mi">87</span>             <span class="n">manager_method</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__doc__</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">returning_fields</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">using</span><span class="p">,</span> <span class="n">ignore_conflicts</span><span class="p">)</span>
   <span class="mi">1252</span>         <span class="n">query</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">InsertQuery</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">ignore_conflicts</span><span class="o">=</span><span class="n">ignore_conflicts</span><span class="p">)</span>
   <span class="mi">1253</span>         <span class="n">query</span><span class="o">.</span><span class="n">insert_values</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
<span class="o">-&gt;</span> <span class="mi">1254</span>         <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">get_compiler</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="n">using</span><span class="p">)</span><span class="o">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="n">returning_fields</span><span class="p">)</span>
   <span class="mi">1255</span>     <span class="n">_insert</span><span class="o">.</span><span class="n">alters_data</span> <span class="o">=</span> <span class="kc">True</span>
   <span class="mi">1256</span>     <span class="n">_insert</span><span class="o">.</span><span class="n">queryset_only</span> <span class="o">=</span> <span class="kc">False</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">sql</span><span class="o">/</span><span class="n">compiler</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">execute_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">returning_fields</span><span class="p">)</span>
   <span class="mi">1395</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
   <span class="mi">1396</span>             <span class="k">for</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_sql</span><span class="p">():</span>
<span class="o">-&gt;</span> <span class="mi">1397</span>                 <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
   <span class="mi">1398</span>             <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">returning_fields</span><span class="p">:</span>
   <span class="mi">1399</span>                 <span class="k">return</span> <span class="p">[]</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
     <span class="mi">96</span>     <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
     <span class="mi">97</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">use_last_executed_query</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="o">---&gt;</span> <span class="mi">98</span>             <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
     <span class="mi">99</span>
    <span class="mi">100</span>     <span class="k">def</span> <span class="nf">executemany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">param_list</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
     <span class="mi">64</span>
     <span class="mi">65</span>     <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="o">---&gt;</span> <span class="mi">66</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_with_wrappers</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">executor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">)</span>
     <span class="mi">67</span>
     <span class="mi">68</span>     <span class="k">def</span> <span class="nf">executemany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">param_list</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_execute_with_wrappers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">many</span><span class="p">,</span> <span class="n">executor</span><span class="p">)</span>
     <span class="mi">73</span>         <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">execute_wrappers</span><span class="p">):</span>
     <span class="mi">74</span>             <span class="n">executor</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">executor</span><span class="p">)</span>
<span class="o">---&gt;</span> <span class="mi">75</span>         <span class="k">return</span> <span class="n">executor</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">many</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
     <span class="mi">76</span>
     <span class="mi">77</span>     <span class="k">def</span> <span class="nf">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">ignored_wrapper_args</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">ignored_wrapper_args</span><span class="p">)</span>
     <span class="mi">82</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
     <span class="mi">83</span>             <span class="k">else</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">84</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
     <span class="mi">85</span>
     <span class="mi">86</span>     <span class="k">def</span> <span class="nf">_executemany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">param_list</span><span class="p">,</span> <span class="o">*</span><span class="n">ignored_wrapper_args</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span>
     <span class="mi">88</span>                 <span class="k">if</span> <span class="n">dj_exc_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">DataError</span><span class="p">,</span> <span class="n">IntegrityError</span><span class="p">):</span>
     <span class="mi">89</span>                     <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">errors_occurred</span> <span class="o">=</span> <span class="kc">True</span>
<span class="o">---&gt;</span> <span class="mi">90</span>                 <span class="k">raise</span> <span class="n">dj_exc_value</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">traceback</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc_value</span>
     <span class="mi">91</span>
     <span class="mi">92</span>     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>


<span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">django</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">ignored_wrapper_args</span><span class="p">)</span>
     <span class="mi">82</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
     <span class="mi">83</span>             <span class="k">else</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">84</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
     <span class="mi">85</span>
     <span class="mi">86</span>     <span class="k">def</span> <span class="nf">_executemany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">param_list</span><span class="p">,</span> <span class="o">*</span><span class="n">ignored_wrapper_args</span><span class="p">):</span>


<span class="n">IntegrityError</span><span class="p">:</span> <span class="n">duplicate</span> <span class="n">key</span> <span class="n">value</span> <span class="n">violates</span> <span class="n">unique</span> <span class="n">constraint</span> <span class="s2">&quot;logos_politician_bioguide_id_317c4279_uniq&quot;</span>
<span class="n">DETAIL</span><span class="p">:</span>  <span class="n">Key</span> <span class="p">(</span><span class="n">bioguide_id</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">J99999</span><span class="p">)</span> <span class="n">already</span> <span class="n">exists</span><span class="o">.</span>
</pre></div>
</div>
<p>So, traditionally, we’d write some code to catch the error, and if he
already exists, we update the existing record instead</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="k">import</span> <span class="n">IntegrityError</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">new_record</span><span class="p">)</span>
<span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bioguide_id</span><span class="o">=</span><span class="n">new_record</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">fec_id</span> <span class="ow">in</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">fec_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pol</span><span class="o">.</span><span class="n">fec_ids</span><span class="p">:</span>
            <span class="n">pol</span><span class="o">.</span><span class="n">fec_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fec_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pol</span><span class="o">.</span><span class="n">last_name</span><span class="p">:</span>
        <span class="n">pol</span><span class="o">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="n">new_record</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span>
    <span class="c1"># ... and so on, and then we save the existing record:</span>
    <span class="c1"># pol.save()</span>
</pre></div>
</div>
<p>We could even be fancier and skip that IntegrityError check</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pol</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">bioguide_id</span><span class="o">=</span><span class="n">new_record</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">fec_id</span> <span class="ow">in</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">fec_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pol</span><span class="o">.</span><span class="n">fec_ids</span><span class="p">:</span>
        <span class="n">pol</span><span class="o">.</span><span class="n">fec_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fec_id</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">pol</span><span class="o">.</span><span class="n">last_name</span><span class="p">:</span>
    <span class="n">pol</span><span class="o">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="n">new_record</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span>
<span class="c1"># ... and so on, and then we save the existing record:</span>
<span class="c1"># pol.save()</span>
</pre></div>
</div>
<p>But this is a royal pain. Often, when we’re trying to harmonize data
from multiple sources, we’re A) working with overlapping but incomplete
records and multiple potential IDs, and B) working with data that can be
easily represented as JSON/dictionary records. So wouldn’t it be nice if
we could just query Django directly with those records, and have it
search for existing records across multiple fields?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_record</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;J99999&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P99999&#39;</span><span class="p">],</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1234567890&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pol</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_if_exists</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">],</span> <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s1">&#39;fec_ids&#39;</span><span class="p">]},</span>
    <span class="n">match_any</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">empty_lists_are_null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_list_overlaps</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> <code class="docutils literal notranslate"><span class="pre">.json</span></code> function can fetch a dictionary
representation of a particular record (the same way <code class="docutils literal notranslate"><span class="pre">.values()</span></code> does
for all of the objects in your query in vanilla Django).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pol</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">exclude_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
 <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dwayne&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;J99999&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>Sweet, we found a match. Now, what if we could give Django some
guidelines, pass it our identifiers AND our new data, and have it
intelligently create or update records all at once?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pol</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_or_update</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">],</span> <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">]},</span>
    <span class="n">new_record</span><span class="p">,</span>
    <span class="n">match_any</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">empty_lists_are_null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_list_overlaps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_update_existing_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_object</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pol</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">exclude_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
 <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dwayne&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;J99999&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P99999&#39;</span><span class="p">],</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1234567890&#39;</span><span class="p">],</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>Depending on the quality and completeness of our data source, we may
have a preference for preserving any existing data, or alternatively
overwriting it. We can control this behavior with some of those keyword
parameters - <code class="docutils literal notranslate"><span class="pre">save_nulls</span></code> (off by default) instructs django_pewtils to
preserve non-null values that are null in our new data;
<code class="docutils literal notranslate"><span class="pre">empty_lists_are_null</span></code> (on by default) determines whether empty lists
should be treated like null values, and <code class="docutils literal notranslate"><span class="pre">only_update_existing_nulls</span></code>
(off by default) is handy if you want to favor existing data and only
want to fill in what’s missing in any existing records.</p>
<p>Now let’s say we collect yet another new record. This time we don’t have
a Bioguide ID, but we do have FEC IDs - in fact, this new data source
has both Mr. Rock’s presidential FEC ID (which we know about) as well as
his Senate race FEC ID (which we don’t). Let’s pass all of the unique
identifiers we have and see what happens.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_record</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;icpsr_id&quot;</span><span class="p">:</span> <span class="s2">&quot;12345&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;S99999&quot;</span><span class="p">,</span> <span class="s2">&quot;P99999&quot;</span><span class="p">],</span>
    <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dwayne&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Johnson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nickname&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_if_exists</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">],</span> <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">]},</span>
    <span class="n">match_any</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">empty_lists_are_null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_list_overlaps</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Why didn’t we find anything? Because we were looking for an exact match
on the list of FEC IDs - by default, <code class="docutils literal notranslate"><span class="pre">get_if_exists</span></code> treats arrays
just like any other value. But if we pass <code class="docutils literal notranslate"><span class="pre">allow_list_overlaps=True</span></code>,
we can tell django_pewtils to not only search for existing records that
overlap with our list, but also to update the existing record with the
<em>union</em> of the lists rather than overwrite what’s already there. (Note:
this only works with databases that support array fields, aka Postgres)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_if_exists</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">],</span> <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">]},</span>
    <span class="n">match_any</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">empty_lists_are_null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_list_overlaps</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_or_update</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">],</span> <span class="s2">&quot;fec_ids&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">]},</span>
    <span class="n">new_record</span><span class="p">,</span>
    <span class="n">match_any</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">empty_lists_are_null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_list_overlaps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_update_existing_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_object</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">exclude_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
 <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dwayne&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;J99999&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P99999&#39;</span><span class="p">,</span> <span class="s1">&#39;S99999&#39;</span><span class="p">],</span>
 <span class="s1">&#39;icpsr_id&#39;</span><span class="p">:</span> <span class="s1">&#39;12345&#39;</span><span class="p">,</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1234567890&#39;</span><span class="p">],</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>Boom - it found our existing record with an overlapping FEC ID, updated
it with the new ICPSR ID, update the FEC IDs to the union, and also
avoided overwriting the existing nickname.</p>
<p>Let’s try saving one more record, but this time we don’t have any unique
identifiers that overlap with our existing data. And there’s a typo in
the data. Great. This is going to cause some problems.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_record</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;opensecrets_id&quot;</span><span class="p">:</span> <span class="s2">&quot;12345&quot;</span><span class="p">,</span>
    <span class="s2">&quot;instagram_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0987654321&quot;</span><span class="p">],</span>
    <span class="s2">&quot;nickname&quot;</span><span class="p">:</span> <span class="s2">&quot;Teh Rock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Johnson&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">also_mr_rock</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_or_update</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;opensecrets_id&quot;</span><span class="p">:</span> <span class="n">new_record</span><span class="p">[</span><span class="s2">&quot;opensecrets_id&quot;</span><span class="p">]},</span>
    <span class="n">new_record</span><span class="p">,</span>
    <span class="n">match_any</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">empty_lists_are_null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_list_overlaps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_update_existing_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_object</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now we’ve unwittingly created two different records for Mr. Rock,
despite our best efforts to leverage all of the overlapping unique
identifiers from our various data sources.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">exclude_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
 <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dwayne&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;J99999&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P99999&#39;</span><span class="p">,</span> <span class="s1">&#39;S99999&#39;</span><span class="p">],</span>
 <span class="s1">&#39;icpsr_id&#39;</span><span class="p">:</span> <span class="s1">&#39;12345&#39;</span><span class="p">,</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1234567890&#39;</span><span class="p">],</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">also_mr_rock</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">exclude_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">64719</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;Teh Rock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;opensecrets_id&#39;</span><span class="p">:</span> <span class="s1">&#39;12345&#39;</span><span class="p">,</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0987654321&#39;</span><span class="p">],</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>What can we do about this? We know about each copy right now - so in
this case, we could manually write some code to resolve the two records
and delete one of them - but in many cases, we aren’t even going to be
<em>aware</em> that a duplicate got created. So our first challenge is: how do
we check a massive database for possible duplicates, if we’ve already
checked all of the obvious unique indicators? And our second challenge
is: if we run into one of these duplicates, how do we resolve them
without having to do it manually every single time?</p>
<p>So let’s start with our original Mr. Rock, and see if we can find his
clone. In this case, the best shot we have at doing this is to look for
other Politician records with similar names. We have a few different
fields that might be useful - first name, last name, and nickname.
Fortunately, Django Pewtils’ <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> and
<code class="docutils literal notranslate"><span class="pre">BasicExtendedManager</span></code> offer a variety of text similarity search
functions.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">similar_by_fuzzy_ratios</span><span class="p">([</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">min_ratio</span><span class="o">=.</span><span class="mi">9</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64719</span><span class="p">,</span>
  <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;Teh Rock&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fuzzy_ratio&#39;</span><span class="p">:</span> <span class="mf">80.0</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">55405</span><span class="p">,</span>
  <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dan&#39;</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fuzzy_ratio&#39;</span><span class="p">:</span> <span class="mf">68.57142857142857</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">54070</span><span class="p">,</span>
  <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Daniel&#39;</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fuzzy_ratio&#39;</span><span class="p">:</span> <span class="mf">68.42105263157895</span><span class="p">}]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">similar_by_levenshtein_differences</span><span class="p">([</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">max_difference</span><span class="o">=.</span><span class="mi">5</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[{</span><span class="s1">&#39;difference&#39;</span><span class="p">:</span> <span class="mf">0.470588235294118</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64719</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;Teh Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">similar_by_tfidf_similarity</span><span class="p">([</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">min_similarity</span><span class="o">=.</span><span class="mi">5</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64719</span><span class="p">,</span>
  <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;Teh Rock&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.5351794382465026</span><span class="p">}]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">similar_by_trigram_similarity</span><span class="p">([</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">min_similarity</span><span class="o">=.</span><span class="mi">5</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.518519</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64719</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;Teh Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Okay, so now we’ve found our duplicate. Now what? Well, Django Pewtils’
<code class="docutils literal notranslate"><span class="pre">consolidate_objects</span></code> function has the ability to collapse duplicate
records. Not only will it let us easily merge our records together the
way we’d like, it’ll also resolve database relations intelligently.
Values that are null in one record but filled in the other will be
filled in, many-to-many relationships and arrays will get merged into
their unions, and if our records have any unique one-to-one
relationships (e.g. each record has a unique “WikipediaPage” assigned to
it, and those are duplicates as well), we can instruct
<code class="docutils literal notranslate"><span class="pre">consolidate_objects</span></code> to cascade to those records and consolidate them
as well. All we need to do is specify which record we want to keep: the
“source” is our duplicate, and we’ll merge it into the “target”, which
is the record that we’ll be keeping.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_pewtils</span> <span class="k">import</span> <span class="n">consolidate_objects</span>

<span class="n">mr_rock</span> <span class="o">=</span> <span class="n">consolidate_objects</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="n">also_mr_rock</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="n">mr_rock</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># False means that we&#39;ll prefer preserving the target&#39;s existing values if we encounter conflicts</span>
    <span class="n">consolidate_related_uniques</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Unless we set this to True, the function will raise an error if there are conflicting relationships that can&#39;t be merged</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">exclude_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
 <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dwayne&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;has_press_release_scraper&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;J99999&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fec_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;S99999&#39;</span><span class="p">,</span> <span class="s1">&#39;P99999&#39;</span><span class="p">],</span>
 <span class="s1">&#39;opensecrets_id&#39;</span><span class="p">:</span> <span class="s1">&#39;12345&#39;</span><span class="p">,</span>
 <span class="s1">&#39;icpsr_id&#39;</span><span class="p">:</span> <span class="s1">&#39;12345&#39;</span><span class="p">,</span>
 <span class="s1">&#39;facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_facebook_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;old_twitter_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;instagram_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0987654321&#39;</span><span class="p">,</span> <span class="s1">&#39;1234567890&#39;</span><span class="p">],</span>
 <span class="s1">&#39;old_instagram_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s1">&#39;capitol_words_speech_backfill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>You know, it would have been nice to avoid all of this in the first
place. What if we could have written some additional checks when we
first loaded in the duplicate Rock record, to search for existing
politicians with similar names? Our duplicate record had values for
<code class="docutils literal notranslate"><span class="pre">nickname</span></code> and <code class="docutils literal notranslate"><span class="pre">last_name</span></code>, so what if we had scanned the database
for matches using those?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_text</span> <span class="o">=</span> <span class="s2">&quot;Teh Rock Johnson&quot;</span>  <span class="c1"># What we had in our duplicate record</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">fuzzy_ratios</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fuzzy_ratio&#39;</span><span class="p">:</span> <span class="mf">93.75</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">55400</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fuzzy_ratio&#39;</span><span class="p">:</span> <span class="mf">66.66666666666666</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">52587</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fuzzy_ratio&#39;</span><span class="p">:</span> <span class="mf">66.66666666666666</span><span class="p">}]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">fuzzy_ratio_best_match</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span><span class="p">,</span> <span class="mf">93.75</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">levenshtein_differences</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[{</span><span class="s1">&#39;difference&#39;</span><span class="p">:</span> <span class="mf">0.125</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;difference&#39;</span><span class="p">:</span> <span class="mf">0.533333333333333</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">48661</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mcneal Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;difference&#39;</span><span class="p">:</span> <span class="mf">0.533333333333333</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">59287</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Roldan-Johnson&#39;</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">levenshtein_difference_best_match</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">tfidf_similarities</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.8116603660917949</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">55651</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.5205634156460611</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">49912</span><span class="p">,</span>
  <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">,</span>
  <span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.5205634156460611</span><span class="p">}]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">tfidf_similarity_best_match</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span><span class="p">,</span> <span class="mf">0.8116603660917949</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">trigram_similarities</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">64716</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;The Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">55400</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">52587</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">trigram_similarity_best_match</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
<p>Some of these searches can take quite a while to run and/or will eat up
a lot of memory when you’ve got a large table. Postgres also has a
built-in search functionality that can more efficiently put the burden
on your database.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">postgres_search</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Dwayne</span> <span class="s1">&#39;The Rock&#39;</span> <span class="n">Johnson</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">William</span> <span class="n">C</span> <span class="n">Kortz</span> <span class="n">II</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Robert</span> <span class="n">Michael</span> <span class="n">Clark</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Abel</span> <span class="n">Maldonado</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Doyel</span> <span class="n">Shamley</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Jamie</span> <span class="n">Moore</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">James</span> <span class="n">A</span> <span class="n">Barnett</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Thomas</span> <span class="n">Catalano</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Abel</span> <span class="n">Gebre</span> <span class="n">Laeke</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Andrew</span> <span class="n">Michael</span> <span class="n">Decker</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">L</span><span class="o">.</span> <span class="n">Mack</span> <span class="n">Van</span> <span class="n">Allen</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Henry</span> <span class="n">W</span> <span class="n">Meers</span> <span class="n">Jr</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Darrel</span> <span class="n">Ervin</span> <span class="n">Miller</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Robert</span> <span class="n">W</span><span class="o">.</span> <span class="n">Tucker</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Oreta</span> <span class="n">Tufaga</span><span class="o">-</span><span class="n">Mapu</span> <span class="n">Crichton</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Phat</span> <span class="n">Nguyen</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Justin</span> <span class="n">Sung</span><span class="o">-</span><span class="n">Sup</span> <span class="n">Kim</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Lei</span> <span class="n">Sharsh</span><span class="o">-</span><span class="n">Davis</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Alan</span> <span class="n">J</span><span class="o">.</span><span class="n">K</span><span class="o">.</span> <span class="n">Yim</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Politician</span><span class="p">:</span> <span class="n">Shirlene</span> <span class="n">D</span><span class="o">.</span> <span class="p">(</span><span class="n">Shirl</span><span class="p">)</span> <span class="n">Ostrov</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;...(remaining elements truncated)...&#39;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Equivalent functions also exist on <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code> so you can
invoke them for specific records, too.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">trigram_similarity</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">search_text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.7</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">similar_by_trigram_similarity</span><span class="p">([</span><span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">],</span> <span class="n">min_similarity</span><span class="o">=.</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PoliticianManager</span> <span class="p">[{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">52587</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">45952</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">46918</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">47003</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">48651</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">49075</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">63555</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">49386</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">49618</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">49836</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">49912</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">50417</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">53745</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">50703</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">53739</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">51020</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">51025</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">51223</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">51250</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;similarity&#39;</span><span class="p">:</span> <span class="mf">0.470588</span><span class="p">,</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="mi">51339</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnson&#39;</span><span class="p">},</span> <span class="s1">&#39;...(remaining elements truncated)...&#39;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Okay, goodbye Mr. Rock.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mr_rock</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;logos.Politician&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Django Pewtils also has a variety of functions for inspecting records in
your database. Let’s take a look at someone a bit more established than
Mr. Rock.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bernie</span> <span class="o">=</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bioguide_id</span><span class="o">=</span><span class="s2">&quot;S000033&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s see what we’ve got on Bernie.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bernie</span><span class="o">.</span><span class="n">related_objects</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{&#39;personal_metrics&#39;: &lt;QueryModelManager [&lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2016, dw_nominate1: -0.526&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2015, comfortable_with_samesex_marriage: 2.0&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2015, privatize_social_security: -2.0&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2019, dw_nominate1: -0.526&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2019, dw_nominate2: -0.371&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2020, dw_nominate1: -0.526&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2020, dw_nominate2: -0.371&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2009, dw_nominate2: -0.296999990940094&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2010, dw_nominate1: -0.50900000333786&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2010, dw_nominate2: -0.296999990940094&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2011, dw_nominate2: -0.296999990940094&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2012, dw_nominate1: -0.50900000333786&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2012, dw_nominate2: -0.296999990940094&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2014, net_worth: 160000.0&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2014, assets: 190000.0&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2014, liabilities: 30000.0&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2015, dw_nominate1: -0.526&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2015, dw_nominate2: -0.371&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2016, dw_nominate2: -0.371&gt;, &lt;PoliticianPersonalMetric: Bernard &#39;Bernie&#39; Sanders, 2017, dw_nominate1: -0.526&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;campaigns&#39;: &lt;CampaignManager [&lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2020 race for President (winner None)&gt;, &lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2018 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2016 race for Senator of Vermont, U.S. Senate (Class 3) (winner Patrick Joseph Leahy)&gt;, &lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2016 race for President (winner None)&gt;, &lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2012 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2006 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Campaign: Bernard &#39;Bernie&#39; Sanders, campaign for 2004 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;]&gt;,
 &#39;staffers&#39;: &lt;QueryModelManager []&gt;,
 &#39;relevant_news_articles&#39;: &lt;QueryModelManager [&lt;NewsArticle: Gates of Vienna, 2015-05-21 00:00:00: Gates of Vienna News Feed 5/20/2015&gt;, &lt;NewsArticle: Gates of Vienna, 2015-05-02 00:00:00: Gates of Vienna News Feed 5/1/2015&gt;, &lt;NewsArticle: Gates of Vienna, 2015-05-22 00:00:00: Gates of Vienna News Feed 5/21/2015&gt;, &lt;NewsArticle: Gates of Vienna, 2015-05-04 00:00:00: Gates of Vienna News Feed 5/3/2015&gt;, &lt;NewsArticle: IHS Global Insight, 2015-05-21 00:00:00: Advocacy groups challenge patents for Gilead&#39;s HCV drug in Argentina, Brazil, China, Russia, and Ukraine&gt;, &lt;NewsArticle: Newstex Blogs
 SaintPetersBlog, 2015-05-27 00:00:00: Sunburn - The morning read of what&#39;s hot in Florida politics - May 27&gt;, &lt;NewsArticle: International Business Times News, 2015-05-19 00:00:00: Why Do Drugs Cost So Much?&gt;, &lt;NewsArticle: Betsy&#39;s Page, 2015-05-12 00:00:00: Cruising the Web&gt;, &lt;NewsArticle: DownWithTyranny, 2015-05-20 00:00:00: Democratic Congressional Candidate Jason Ritchie Makes The Case For Opposing TPP&gt;, &lt;NewsArticle: The Daily Dot, 2015-05-17 00:00:00: Du Vote, the tech that could make online voting safe&gt;, &lt;NewsArticle: Washington Post Blogs, 2015-05-19 00:00:00: Minorities and poor college students are shouldering the most student debt&gt;, &lt;NewsArticle: Atlantic Online, 2015-05-04 00:00:00: The Audacity of Ben Carson and Carly Fiorina&gt;, &lt;NewsArticle: Dissident Voice, 2015-05-13 00:00:00: Middle Class? What Middle Class?&gt;, &lt;NewsArticle: Washington Post Blogs, 2015-05-03 00:00:00: With little choice, O&#39;Malley defends Baltimore tenure;  The former mayor plans to announce presidential campaign there despite critique of zero-tolerance policing.&gt;, &lt;NewsArticle: Washingtonpost.com, 2015-05-04 00:00:00: With little choice and under scrutiny, O&#39;Malley embraces tenure as mayor&gt;, &lt;NewsArticle: Washington Post Blogs, 2015-05-11 00:00:00: Obama has harsh words for Warren on free trade&gt;, &lt;NewsArticle: Phil&#39;s Stock World, 2015-05-07 00:00:00: News You Can Use From Phil&#39;s Stock World&gt;, &lt;NewsArticle: Washington Post BlogsThe Plum Line, 2015-05-28 00:00:00: Morning Plum: Jeb Bush rips Republicans for &#39;bending with the wind&#39; on immigration;  But Bush has not been as courageous on the issue as he suggests.&gt;, &lt;NewsArticle: ColoradoPols.com, 2015-05-05 00:00:00: Get More Smarter on Tuesday (May 5)&gt;, &lt;NewsArticle: AMERICAblog, 2015-05-18 00:00:00: The Blue Wall exists for a reason: The GOP built it&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;press_releases&#39;: &lt;PressReleaseManager [&lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2015-04-14 00:00:00: HHS to Probe Skyrocketing Generic Drug Prices&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2013-09-02 00:00:00: Vermont&#39;s &#39;age wave&#39; brings jobs&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2013-07-26 00:00:00: Obama Said Not Ready to Decide on Fed Chief for Weeks&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2013-07-12 00:00:00: Vermont receives an additional $42M to help exchange&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2010-09-30 00:00:00: Release: Congress Steps Up to Protect Social Security&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2008-10-22 00:00:00: Rebuild America&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2015-03-17 00:00:00: Sanders: House Budget Plan is an Assault on the Middle Class and a Gift to Millionaires and Billionaires&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2013-07-23 00:00:00: Could job cuts hurt Vermont Yankee&#39;s case before PSB?&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2008-10-20 00:00:00: Rebuild America&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2009-01-11 00:00:00: Sanders: Why Not Fire Failed Tycoons?&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2013-11-21 00:00:00: SEN. SANDERS ISSUES STATEMENT ON MAJORITY RULE IN THE SENATE&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2008-05-27 00:00:00: Ike Was Right&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2015-08-26 00:00:00: Sanders Sends Letter to Postmaster General&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2009-08-20 00:00:00: Federal Grants for Vermont Communities to Counter Drug And Substance Abuse&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2014-04-22 00:00:00: Earth Day&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2007-11-14 00:00:00: A good, long look&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2008-01-15 00:00:00: Fire!&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2009-05-06 00:00:00: Encouraging Renewable Energy&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2010-01-08 00:00:00: Release: GE in Rutland Wins $12 Million Clean Energy Stimulus, Delegation Announces&gt;, &lt;PressRelease: Bernard &#39;Bernie&#39; Sanders, 2013-08-27 00:00:00: Vermont Yankee Shutdown is &#39;Good News,&#39; Sanders Says&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;ballotpedia_page&#39;: &lt;QueryModelManager [&lt;BallotpediaPage: BallotpediaPage object (599)&gt;]&gt;,
 &#39;wikipedia_page&#39;: &lt;QueryModelManager [&lt;WikipediaPage: WikipediaPage object (1691)&gt;]&gt;,
 &#39;speeches&#39;: &lt;QueryModelManager [&lt;Speech: Speech object (1255897)&gt;, &lt;Speech: Speech object (1255895)&gt;, &lt;Speech: Speech object (1255893)&gt;, &lt;Speech: Speech object (1255891)&gt;, &lt;Speech: Speech object (1255889)&gt;, &lt;Speech: Speech object (1255887)&gt;, &lt;Speech: Speech object (1255883)&gt;, &lt;Speech: Speech object (1255881)&gt;, &lt;Speech: Speech object (1248748)&gt;, &lt;Speech: Speech object (1248742)&gt;, &lt;Speech: Speech object (1248738)&gt;, &lt;Speech: Speech object (1248736)&gt;, &lt;Speech: Speech object (1241197)&gt;, &lt;Speech: Speech object (1238387)&gt;, &lt;Speech: Speech object (1238385)&gt;, &lt;Speech: Speech object (1238383)&gt;, &lt;Speech: Speech object (1238381)&gt;, &lt;Speech: Speech object (1235399)&gt;, &lt;Speech: Speech object (1235396)&gt;, &lt;Speech: Speech object (1235394)&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;twitter_profiles&#39;: &lt;MergedTwitterProfileManager [&lt;TwitterProfile: sensanders (Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;TwitterProfile: berniesanders (Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;TwitterProfile: senatorsanders (Bernard &#39;Bernie&#39; Sanders)&gt;]&gt;,
 &#39;incumbent_elections&#39;: &lt;QueryModelManager [&lt;Election: 2012 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 2004 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;]&gt;,
 &#39;elections_won&#39;: &lt;QueryModelManager [&lt;Election: 2018 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 2012 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 2006 race for Senator of Vermont, U.S. Senate (Class 1) (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 2004 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 2002 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 2000 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 1998 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 1996 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 1994 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 1992 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;Election: 1990 race for Representative of Vermont, District At-Large (historical), U.S. House of Representatives (winner Bernard &#39;Bernie&#39; Sanders)&gt;]&gt;,
 &#39;contributions_donated&#39;: &lt;QueryModelManager []&gt;,
 &#39;contributions_received&#39;: &lt;QueryModelManager []&gt;,
 &#39;facebook_pages&#39;: &lt;MergedFacebookPageManager [&lt;FacebookPage: berniesanders (Bernard &#39;Bernie&#39; Sanders)&gt;, &lt;FacebookPage: senatorsanders (Bernard &#39;Bernie&#39; Sanders)&gt;]&gt;,
 &#39;terms&#39;: &lt;QueryModelManager [&lt;Term: Bernard &#39;Bernie&#39; Sanders term as Senator of Vermont, U.S. Senate (Class 1), 2019 - 2025&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Senator of Vermont, U.S. Senate (Class 1), 2013 - 2019&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Senator of Vermont, U.S. Senate (Class 1), 2007 - 2013&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 2005 - 2007&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 2003 - 2005&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 2001 - 2003&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 1999 - 2001&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 1997 - 1999&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 1995 - 1997&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 1993 - 1995&gt;, &lt;Term: Bernard &#39;Bernie&#39; Sanders term as Representative of Vermont, District At-Large (historical), U.S. House of Representatives, 1991 - 1993&gt;]&gt;,
 &#39;chaired_committees&#39;: &lt;QueryModelManager []&gt;,
 &#39;ranking_member_committees&#39;: &lt;QueryModelManager [&lt;Committee: Senate Committee on Budget, &lt;LegislatureManager [&lt;Legislature: U.S. Senate&gt;]&gt;&gt;, &lt;Committee: Primary Health and Aging, &lt;LegislatureManager [&lt;Legislature: U.S. Senate&gt;]&gt;&gt;]&gt;,
 &#39;committees&#39;: &lt;QueryModelManager []&gt;,
 &#39;committee_memberships&#39;: &lt;QueryModelManager [&lt;CommitteeMembership: CommitteeMembership object (164934)&gt;, &lt;CommitteeMembership: CommitteeMembership object (150092)&gt;, &lt;CommitteeMembership: CommitteeMembership object (161558)&gt;, &lt;CommitteeMembership: CommitteeMembership object (165308)&gt;, &lt;CommitteeMembership: CommitteeMembership object (164893)&gt;, &lt;CommitteeMembership: CommitteeMembership object (161149)&gt;, &lt;CommitteeMembership: CommitteeMembership object (168701)&gt;, &lt;CommitteeMembership: CommitteeMembership object (165447)&gt;, &lt;CommitteeMembership: CommitteeMembership object (168757)&gt;, &lt;CommitteeMembership: CommitteeMembership object (168688)&gt;, &lt;CommitteeMembership: CommitteeMembership object (153618)&gt;, &lt;CommitteeMembership: CommitteeMembership object (164978)&gt;, &lt;CommitteeMembership: CommitteeMembership object (161133)&gt;, &lt;CommitteeMembership: CommitteeMembership object (149705)&gt;, &lt;CommitteeMembership: CommitteeMembership object (161709)&gt;, &lt;CommitteeMembership: CommitteeMembership object (168497)&gt;, &lt;CommitteeMembership: CommitteeMembership object (161526)&gt;, &lt;CommitteeMembership: CommitteeMembership object (161203)&gt;, &lt;CommitteeMembership: CommitteeMembership object (149883)&gt;, &lt;CommitteeMembership: CommitteeMembership object (164994)&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;caucuses&#39;: &lt;QueryModelManager [&lt;Caucus: Congressional Progressive Caucus&gt;]&gt;,
 &#39;sponsored_bills&#39;: &lt;QueryModelManager [&lt;Bill: U.S. Senate s3044-114: Puerto Rico Humanitarian Relief and Reconstruction Act&gt;, &lt;Bill: U.S. Senate s2399-114: Climate Protection and Justice Act of 2015&gt;, &lt;Bill: U.S. Senate s2398-114: Clean Energy Worker Just Transition Act&gt;, &lt;Bill: U.S. Senate s2391-114: American Clean Energy Investment Act of 2015&gt;, &lt;Bill: U.S. Senate s2242-114: Save Oak Flat Act&gt;, &lt;Bill: U.S. Senate s2237-114: Ending Federal Marijuana Prohibition Act of 2015&gt;, &lt;Bill: U.S. Senate s2142-114: Workplace Democracy Act&gt;, &lt;Bill: U.S. Senate s2054-114: Justice is Not For Sale Act of 2015&gt;, &lt;Bill: U.S. Senate s2023-114: Prescription Drug Affordability Act of 2015&gt;, &lt;Bill: U.S. Senate s1970-114: Raising Enrollment with a Government Initiated System for Timely Electoral Registration (REGISTER) Act of 2015&gt;, &lt;Bill: U.S. Senate s1969-114: Democracy Day Act of 2015&gt;, &lt;Bill: U.S. Senate s1832-114: Pay Workers a Living Wage Act&gt;, &lt;Bill: U.S. Senate s1713-114: Low-Income Solar Act&gt;, &lt;Bill: U.S. Senate s1677-114: Responsible Estate Tax Act&gt;, &lt;Bill: U.S. Senate s1631-114: Keep Our Pension Promises Act&gt;, &lt;Bill: U.S. Senate s1564-114: Guaranteed Paid Vacation Act&gt;, &lt;Bill: U.S. Senate s1506-114: Employ Young Americans Now Act&gt;, &lt;Bill: U.S. Senate s1373-114: College for All Act&gt;, &lt;Bill: U.S. Senate s1371-114: Inclusive Prosperity Act of 2015&gt;, &lt;Bill: U.S. Senate s1366-114: None&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;cosponsored_bills&#39;: &lt;QueryModelManager [&lt;Bill: U.S. Senate sres640-114: None&gt;, &lt;Bill: U.S. Senate sres633-114: None&gt;, &lt;Bill: U.S. Senate sres632-114: None&gt;, &lt;Bill: U.S. Senate sres590-114: None&gt;, &lt;Bill: U.S. Senate sres581-114: No Vote No Recess Resolution&gt;, &lt;Bill: U.S. Senate sres561-114: None&gt;, &lt;Bill: U.S. Senate sres539-114: None&gt;, &lt;Bill: U.S. Senate sres530-114: None&gt;, &lt;Bill: U.S. Senate sres523-114: None&gt;, &lt;Bill: U.S. Senate sconres45-114: None&gt;, &lt;Bill: U.S. Senate s3491-114: Justice for Victims of Fraud Act of 2016&gt;, &lt;Bill: U.S. Senate s3476-114: National Guard Bonus Repayment and Financial Relief Act&gt;, &lt;Bill: U.S. Senate s3328-114: Department of Veterans Affairs Appeals Modernization Act of 2016&gt;, &lt;Bill: U.S. Senate s3321-114: Empowering States&#39; Rights To Protect Consumers Act of 2016&gt;, &lt;Bill: U.S. Senate s3309-114: Voter Empowerment Act of 2015&gt;, &lt;Bill: U.S. Senate s3252-114: Automatic Voter Registration Act of 2016&gt;, &lt;Bill: U.S. Senate sres202-115: None&gt;, &lt;Bill: U.S. Senate sres201-115: None&gt;, &lt;Bill: U.S. Senate sres193-115: None&gt;, &lt;Bill: U.S. Senate sres184-115: None&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;votes_for&#39;: &lt;QueryModelManager [&lt;Vote: Vote On the Motion to Table H.R. 3326 on U.S. House of Representatives hr3326-111: Department of Defense Appropriations Act, 2010, 2009-12-19 00:00:00&gt;, &lt;Vote: Vote On the Motion (Motion To Concur In The House Amdt. To The Senate Amdt.) on U.S. House of Representatives hr3326-111: Department of Defense Appropriations Act, 2010, 2009-12-19 00:00:00&gt;, &lt;Vote: Vote On the Motion (Motion to Waive CBA and All Budget Resolutions Re: Motion to Concur in House Amdt. to H.R. 3326) on U.S. House of Representatives hr3326-111: Department of Defense Appropriations Act, 2010, 2009-12-19 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. House of Representatives hr3590-111: Patient Protection and Affordable Care Act, 2009-12-21 00:00:00&gt;, &lt;Vote: Vote On the Motion to Table S.Amdt. 4309 to S.Con.Res. 70 (No short title on file) on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. House of Representatives hr3326-111: Department of Defense Appropriations Act, 2010, 2009-12-18 00:00:00&gt;, &lt;Vote: Vote On the Motion (Motion to Waive Rule XXVIII Re: Conference Report to Accompany H.R. 3288) on U.S. House of Representatives hr3288-111: Consolidated Appropriations Act, 2010, 2009-12-11 00:00:00&gt;, &lt;Vote: Vote On the Motion to Proceed on U.S. House of Representatives hr3288-111: Consolidated Appropriations Act, 2010, 2009-12-10 00:00:00&gt;, &lt;Vote: Vote On the Motion to Table S.Amdt. 3278 to H.R. 3590 (Service Members Home Ownership Tax Act of 2009) on U.S. House of Representatives hr3590-111: Patient Protection and Affordable Care Act, 2009-12-22 00:00:00&gt;, &lt;Vote: Vote Call of the House by States on None, 2005-01-04 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on None, 2014-07-15 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2014-07-09 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2014-06-26 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2014-06-24 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on None, 2014-07-15 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2014-07-10 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on None, 2014-06-23 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2014-07-07 00:00:00&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;votes_against&#39;: &lt;QueryModelManager [&lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Motion (Motion to Waive C.B.A. Cornyn Amdt. No. 4242) on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate sconres70-110: None, 2008-03-13 00:00:00&gt;, &lt;Vote: Vote On Consideration of the Resolution on U.S. House of Representatives hres5-109: None, 2005-01-04 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. House of Representatives hr2-114: Medicare Access and CHIP Reauthorization Act of 2015, 2015-04-14 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. House of Representatives hr2-114: Medicare Access and CHIP Reauthorization Act of 2015, 2015-04-14 00:00:00&gt;, &lt;Vote: Vote On Ordering the Previous Question on U.S. House of Representatives hres5-109: None, 2005-01-04 00:00:00&gt;, &lt;Vote: Vote On the Resolution on U.S. House of Representatives hres5-109: None, 2005-01-04 00:00:00&gt;, &lt;Vote: Vote On Agreeing to the Objection on None, 2005-01-06 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. House of Representatives hr2-114: Medicare Access and CHIP Reauthorization Act of 2015, 2015-04-14 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. House of Representatives hr2029-114: Military Construction and Veterans Affairs and Related Agencies Appropriations Act, 2016, 2015-12-18 00:00:00&gt;, &lt;Vote: Vote On the Motion (Motion to Waive All Applicable Budgetary Discipline Re: Motion to Concur in the House Amendments to the Senate Amendment to H.R. 2029) on U.S. House of Representatives hr2029-114: Military Construction and Veterans Affairs and Related Agencies Appropriations Act, 2016, 2015-12-18 00:00:00&gt;, &lt;Vote: Vote On the Motion (Motion to Concur in the House Amendments to the Senate Amendment to H.R. 2029) on U.S. House of Representatives hr2029-114: Military Construction and Veterans Affairs and Related Agencies Appropriations Act, 2016, 2015-12-18 00:00:00&gt;, &lt;Vote: Vote On Passage of the Bill on U.S. House of Representatives hr54-109: Congressional Gold Medal Enhancement Act of 2005, 2005-01-26 00:00:00&gt;, &lt;Vote: Vote On the Resolution on U.S. House of Representatives hconres36-109: None, 2005-02-02 00:00:00&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;votes_abstained&#39;: &lt;QueryModelManager [&lt;Vote: Vote On the Nomination on None, 2016-01-11 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2016-01-19 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. House of Representatives hr4038-114: American SAFE Act of 2015, 2016-01-20 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. Senate sjres22-114: None, 2016-01-21 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2016-01-27 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-01-28 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-01-28 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-01-28 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-02 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-02 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-02 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-02 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-02 00:00:00&gt;, &lt;Vote: Vote On the Amendment on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-02 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-04 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. Senate s2012-114: Energy Policy Modernization Act of 2016, 2016-02-04 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2016-02-08 00:00:00&gt;, &lt;Vote: Vote On the Nomination on None, 2016-02-09 00:00:00&gt;, &lt;Vote: Vote On Passage of the Bill on U.S. House of Representatives hr757-114: North Korea Sanctions Enforcement Act of 2015, 2016-02-10 00:00:00&gt;, &lt;Vote: Vote On the Cloture Motion on U.S. House of Representatives hr644-114: Trade Facilitation and Trade Enforcement Act of 2015, 2016-02-11 00:00:00&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;hearings&#39;: &lt;QueryModelManager [&lt;LegislativeHearing: 72 CHRG-114shrg94051: [datetime.date(2015, 3, 19)]&gt;, &lt;LegislativeHearing: 14284 CHRG-110shrg36643: [datetime.date(2007, 4, 25)]&gt;, &lt;LegislativeHearing: 14291 CHRG-110shrg34335: [datetime.date(2007, 3, 14)]&gt;, &lt;LegislativeHearing: 14292 CHRG-110shrg40573: [datetime.date(2007, 9, 27)]&gt;, &lt;LegislativeHearing: 9563 CHRG-109hhrg29458: [datetime.date(2005, 6, 23)]&gt;, &lt;LegislativeHearing: 8663 CHRG-108hhrg94689: [datetime.date(2004, 3, 30)]&gt;, &lt;LegislativeHearing: 8665 CHRG-108hhrg95012: [datetime.date(2004, 5, 18)]&gt;, &lt;LegislativeHearing: 345 CHRG-114shrg96272: [datetime.date(2015, 8, 17)]&gt;, &lt;LegislativeHearing: 8677 CHRG-108hhrg96529: [datetime.date(2004, 7, 15)]&gt;, &lt;LegislativeHearing: 4084 CHRG-112shrg94198: [datetime.date(2012, 11, 15)]&gt;, &lt;LegislativeHearing: 7770 CHRG-108hhrg89409: [datetime.date(2003, 4, 10)]&gt;, &lt;LegislativeHearing: 8694 CHRG-108hhrg96545: [datetime.date(2004, 4, 28)]&gt;, &lt;LegislativeHearing: 8698 CHRG-108hhrg94688: [datetime.date(2004, 3, 25)]&gt;, &lt;LegislativeHearing: 7777 CHRG-108hhrg89633: [datetime.date(2003, 5, 22)]&gt;, &lt;LegislativeHearing: 8718 CHRG-108hhrg96546: [datetime.date(2004, 5, 3)]&gt;, &lt;LegislativeHearing: 9721 CHRG-109hhrg28102: [datetime.date(2005, 7, 19)]&gt;, &lt;LegislativeHearing: 7780 CHRG-108hhrg91543: [datetime.date(2003, 6, 17)]&gt;, &lt;LegislativeHearing: 8724 CHRG-108hhrg93841: [datetime.date(2004, 3, 18)]&gt;, &lt;LegislativeHearing: 2851 CHRG-113shrg94431: [datetime.date(2013, 3, 14)]&gt;, &lt;LegislativeHearing: 7797 CHRG-108hhrg91303: [datetime.date(2003, 10, 8)]&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;scrape_logs&#39;: &lt;ScrapeLogManager [&lt;ScrapeLog: ScrapeLog object (1083)&gt;, &lt;ScrapeLog: ScrapeLog object (1082)&gt;, &lt;ScrapeLog: ScrapeLog object (1081)&gt;]&gt;,
 &#39;webpages&#39;: &lt;WebpageManager [&lt;Webpage: 232e6cb76ab068afb772f670b2e9a913&gt;, &lt;Webpage: 2ca773ae3bdd0c424b3672b5b9194208&gt;, &lt;Webpage: c1ac6146dfe6520a029c6cf0812561ad&gt;, &lt;Webpage: eec968dae00e21cd710860082c2bd82d&gt;, &lt;Webpage: 9018d1511cf46681a964719a346a654d&gt;, &lt;Webpage: edd9cdde8b570ebbbfbc70d0eec10c55&gt;, &lt;Webpage: 21d73276ff8ef92a17fe3d906376cd2e&gt;, &lt;Webpage: ad6ad2636640bd50f8317bc67c633116&gt;, &lt;Webpage: 25f0981e0ac67bda6ad06b55206af734&gt;, &lt;Webpage: 147f948c5defe278dc5d014205b379b1&gt;, &lt;Webpage: 7a416fda677ae1e7c4a4e284b6c54f86&gt;, &lt;Webpage: d2e5d410055e75dc072067d5aac18e57&gt;, &lt;Webpage: f10191506e6097a96886b32e7dbaa7c6&gt;, &lt;Webpage: 362cd980f72a5c9c02891bda27dfdad7&gt;, &lt;Webpage: 1485789318324a08f944b4e95c1db0db&gt;, &lt;Webpage: b8bc12cca78d8efdb8465cbef3006ea8&gt;, &lt;Webpage: c6a245a7bd66e04dc1f59cb6afca91d1&gt;, &lt;Webpage: 1cc70e7fbb725e103b45155c744b28af&gt;, &lt;Webpage: 7a980b3dbcf1aa618f2a1fb4ee28fd59&gt;, &lt;Webpage: 64d37b16892d4e32a9011b57114d2b73&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;current_term&#39;: &lt;QueryModelManager [&lt;Term: Bernard &#39;Bernie&#39; Sanders term as Senator of Vermont, U.S. Senate (Class 1), 2019 - 2025&gt;]&gt;,
 &#39;latest_term&#39;: &lt;QueryModelManager [&lt;Term: Bernard &#39;Bernie&#39; Sanders term as Senator of Vermont, U.S. Senate (Class 1), 2019 - 2025&gt;]&gt;,
 &#39;party&#39;: &lt;PartyManager [&lt;Party: Democratic Party&gt;]&gt;,
 &#39;commands&#39;: &lt;BasicExtendedManager [&lt;Command: load_pew_data_labs_politician_social_media_accounts {}&gt;, &lt;Command: load_pew_data_labs_scraper_press_releases {&#39;mode&#39;: &#39;reparse_existing&#39;}&gt;, &lt;Command: load_united_states_github_congress_members {}&gt;, &lt;Command: load_united_states_github_congress_member_social_media {}&gt;, &lt;Command: load_pew_data_labs_mturk_politician_social_media_accounts {}&gt;, &lt;Command: load_sunlight_current_congress_members {}&gt;, &lt;Command: load_facebook_politician_pages {}&gt;, &lt;Command: load_twitter_politician_profiles {}&gt;, &lt;Command: load_pew_data_labs_scraper_press_releases {&#39;mode&#39;: &#39;new&#39;}&gt;, &lt;Command: load_wikipedia_politician_pages {}&gt;, &lt;Command: clean_remove_duplicate_politician_press_releases {}&gt;, &lt;Command: logos_load_facebook_politician_pages {}&gt;, &lt;Command: commands_load_twitter_politician_profiles {}&gt;, &lt;Command: commands_load_facebook_politician_pages {}&gt;, &lt;Command: commands_load_united_states_github_congress_members {}&gt;, &lt;Command: commands_load_united_states_github_congress_member_social_media {}&gt;, &lt;Command: load_bioguide_politician_bios {}&gt;, &lt;Command: politician_profiles {}&gt;, &lt;Command: data_labs_politician_social_media_accounts {}&gt;, &lt;Command: states_github_congress_members {}&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;command_logs&#39;: &lt;BasicExtendedManager [&lt;CommandLog: load_pew_data_labs_politician_social_media_accounts {} (pk=27787): COMPLETED&gt;, &lt;CommandLog: load_pew_data_labs_politician_social_media_accounts {} (pk=27790): COMPLETED&gt;, &lt;CommandLog: load_pew_data_labs_politician_social_media_accounts {} (pk=27792): COMPLETED&gt;, &lt;CommandLog: load_pew_data_labs_scraper_press_releases {&#39;mode&#39;: &#39;reparse_existing&#39;} (pk=28027): RUNNING&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28113): COMPLETED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28115): COMPLETED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28116): COMPLETED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28117): FAILED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28118): RUNNING&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28119): RUNNING&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28120): RUNNING&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28121): COMPLETED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28122): RUNNING&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28123): RUNNING&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28124): COMPLETED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28126): FAILED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28128): FAILED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28130): FAILED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28131): FAILED&gt;, &lt;CommandLog: load_united_states_github_congress_members {} (pk=28132): COMPLETED&gt;, &#39;...(remaining elements truncated)...&#39;]&gt;,
 &#39;verifications&#39;: &lt;VerificationManager []&gt;}
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bernie</span><span class="o">.</span><span class="n">related_objects</span><span class="p">(</span><span class="n">counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;personal_metrics&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
 <span class="s1">&#39;campaigns&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
 <span class="s1">&#39;staffers&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">&#39;relevant_news_articles&#39;</span><span class="p">:</span> <span class="mi">96109</span><span class="p">,</span>
 <span class="s1">&#39;press_releases&#39;</span><span class="p">:</span> <span class="mi">3326</span><span class="p">,</span>
 <span class="s1">&#39;ballotpedia_page&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;wikipedia_page&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;speeches&#39;</span><span class="p">:</span> <span class="mi">2890</span><span class="p">,</span>
 <span class="s1">&#39;twitter_profiles&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;incumbent_elections&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;elections_won&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
 <span class="s1">&#39;contributions_donated&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">&#39;contributions_received&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">&#39;facebook_pages&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;terms&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
 <span class="s1">&#39;chaired_committees&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">&#39;ranking_member_committees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;committees&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">&#39;committee_memberships&#39;</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>
 <span class="s1">&#39;caucuses&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;sponsored_bills&#39;</span><span class="p">:</span> <span class="mi">235</span><span class="p">,</span>
 <span class="s1">&#39;cosponsored_bills&#39;</span><span class="p">:</span> <span class="mi">2638</span><span class="p">,</span>
 <span class="s1">&#39;votes_for&#39;</span><span class="p">:</span> <span class="mi">3320</span><span class="p">,</span>
 <span class="s1">&#39;votes_against&#39;</span><span class="p">:</span> <span class="mi">1918</span><span class="p">,</span>
 <span class="s1">&#39;votes_abstained&#39;</span><span class="p">:</span> <span class="mi">343</span><span class="p">,</span>
 <span class="s1">&#39;hearings&#39;</span><span class="p">:</span> <span class="mi">1059</span><span class="p">,</span>
 <span class="s1">&#39;scrape_logs&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;webpages&#39;</span><span class="p">:</span> <span class="mi">2193</span><span class="p">,</span>
 <span class="s1">&#39;current_term&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;latest_term&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;party&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
 <span class="s1">&#39;command_logs&#39;</span><span class="p">:</span> <span class="mi">1108</span><span class="p">,</span>
 <span class="s1">&#39;verifications&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</pre></div>
</div>
<p>Looks like we’ve got a lot of data on Bernie. What would happen if we
deleted him? Deleting a record in a database can cause a lot of
unexpected cascade behavior if you aren’t careful! The
<code class="docutils literal notranslate"><span class="pre">inspect_delete</span></code> function in Django Pewtils’ <code class="docutils literal notranslate"><span class="pre">BasicExtendedModel</span></code>
can help you make sure you’re not going to do something you’ll regret.
(You can also run this on queries too.)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bernie</span><span class="o">.</span><span class="n">inspect_delete</span><span class="p">(</span><span class="n">counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span>
            <span class="p">{</span><span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">Politician</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">Politician_commands</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">Politician_command_logs</span><span class="p">:</span> <span class="mi">1108</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">PoliticianPersonalMetric</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">PoliticianPersonalMetric_commands</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">PoliticianPersonalMetric_command_logs</span><span class="p">:</span> <span class="mi">167</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">media</span><span class="o">.</span><span class="n">NewsArticle_relevant_politicians</span><span class="p">:</span> <span class="mi">96109</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">media</span><span class="o">.</span><span class="n">BallotpediaPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">media</span><span class="o">.</span><span class="n">WikipediaPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">media</span><span class="o">.</span><span class="n">WikipediaPage_commands</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">media</span><span class="o">.</span><span class="n">WikipediaPage_command_logs</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">CommitteeMembership</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">CommitteeMembership_commands</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">CommitteeMembership_command_logs</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">Caucus_members</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">Bill_cosponsors</span><span class="p">:</span> <span class="mi">2638</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">Vote_votes_for</span><span class="p">:</span> <span class="mi">3320</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">Vote_votes_against</span><span class="p">:</span> <span class="mi">1918</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">Vote_votes_abstained</span><span class="p">:</span> <span class="mi">343</span><span class="p">,</span>
             <span class="n">logos</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">government</span><span class="o">.</span><span class="n">LegislativeHearing_attendees</span><span class="p">:</span> <span class="mi">1059</span><span class="p">})</span>
</pre></div>
</div>
<p>So, let’s maybe <em>not</em> do that.</p>
<p>Anyway, that’s some of the handy stuff in Django Pewtils!</p>
<p>Let’s make sure we deleted all of our Rocks, just in case:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">unique_id</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;S99999&quot;</span><span class="p">,</span> <span class="s2">&quot;P99999&quot;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s2">&quot;fec_ids&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;P99999&#39;</span><span class="p">,</span> <span class="s1">&#39;H99999&#39;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">,</span> <span class="s2">&quot;J99999&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;icpsr_id&quot;</span><span class="p">,</span> <span class="s2">&quot;12345&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;opensecrets_id&quot;</span><span class="p">,</span> <span class="s2">&quot;12345&quot;</span><span class="p">)</span>
<span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span> <span class="n">Politician</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">field</span><span class="p">:</span> <span class="n">unique_id</span><span class="p">})</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Politician</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="managers.html" class="btn btn-neutral float-left" title="django_pewtils.managers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Pew Research Center

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>